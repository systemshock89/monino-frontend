{"version":3,"file":"../forms.min.js","sources":["forms.min.js"],"sourcesContent":["\"use strict\";\r\n\r\ndocument.addEventListener(\"DOMContentLoaded\", function() {\r\n    try {\r\n        Fancybox.bind(\"[data-fancybox]:where(.button, .button2, .footer__form)\", {\r\n            dragToClose: getComputedStyle(document.querySelector('.header__mobile')).display === 'flex' ? false : true, // bug: click to button misses on mobile\r\n            on: {\r\n                reveal: (fancybox, slide) => {\r\n                    const formId = slide.el.querySelector('form').getAttribute('id');\r\n                    initSubmitForm(formId);\r\n\r\n                    if(slide.contentEl.classList.contains('modal_cost')){\r\n                        formFieldProductButton(fancybox, slide);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    } catch (err) {\r\n        console.log(err);\r\n    }\r\n});\r\n\r\nfunction initSubmitForm(formId) {\r\n\r\n    const form = document.forms[formId];\r\n    const extKey = form.dataset.extKey;\r\n    const formButton = form.querySelector(`.form__button`);\r\n    const formFieldPersonal = form.querySelector(`.form__field_personal`);\r\n    let formFieldPersonalCheckbox;\r\n    if(formFieldPersonal){\r\n        formFieldPersonalCheckbox = formFieldPersonal.querySelector(`.checkbox__input`);\r\n    }\r\n\r\n    // submit\r\n    form.addEventListener('submit', (e) => {\r\n        e.preventDefault();\r\n\r\n        let not_empty_exist = 0;\r\n        let not_valid_exist = 0;\r\n        let valid_agree = false;\r\n\r\n        if (formFieldPersonal) {\r\n            if (formFieldPersonalCheckbox.checked) {\r\n                valid_agree = true;\r\n            } else {\r\n                formFieldPersonal.classList.add(\"form__field_error\");\r\n            }\r\n        } else {\r\n            valid_agree = true;\r\n        }\r\n\r\n        form.querySelectorAll('.valid_req').forEach(field => {\r\n            if (field.value === '' || field.value === '0') {\r\n                field.closest('.form__field').classList.add('form__field_error');\r\n                not_empty_exist = 1;\r\n            }\r\n        });\r\n\r\n        form.querySelectorAll('.form__field_fio .valid_req').forEach(field => {\r\n            if (field.value && !isValidFio(field.value)) {\r\n                field.closest('.form__field').classList.add('form__field_error');\r\n                not_empty_exist = 1;\r\n            }\r\n        });\r\n\r\n        form.querySelectorAll('.valid_mail').forEach(field => {\r\n            if (field.value && !isValidEmailAddress(field.value)) {\r\n                field.closest('.form__field').classList.add('form__field_error');\r\n                not_valid_exist = 1;\r\n            }\r\n        });\r\n\r\n        form.querySelectorAll('.valid_phone').forEach(field => {\r\n            if (field.value && !isValidTel(field.value)) {\r\n                field.closest('.form__field').classList.add('form__field_error');\r\n                not_valid_exist = 1;\r\n            }\r\n        });\r\n\r\n        if (!not_empty_exist && !not_valid_exist && valid_agree) {\r\n            formButton.disabled = true;\r\n            showLoader();\r\n\r\n            let text_send = \"Ваша заявка отправлена!\";\r\n            const data_text_send = formButton.dataset.text_send;\r\n\r\n            if (data_text_send != \"\") {\r\n                text_send = data_text_send;\r\n            }\r\n\r\n            const type_send = formButton.dataset.type_send;\r\n            let yam = formButton.dataset.yam;\r\n            const id_target_ym = form.querySelector(\".id_target_ym\");\r\n\r\n            if (id_target_ym) {\r\n                if (id_target_ym && id_target_ym.value != \"\") {\r\n                    yam = id_target_ym.value;\r\n                }\r\n            }\r\n\r\n            const open_in_popap = formButton.dataset.open_in_popap;\r\n\r\n            form.querySelector(`.form_sp_sec`).value = 'f2d2g54j5y2f5';\r\n\r\n            if (type_send == \"ajax\") {\r\n                const formData = new FormData(form);\r\n                const serializeArray = [];\r\n                for (const [name, value] of formData.entries()) {\r\n                    serializeArray.push({name, value});\r\n                }\r\n\r\n                let file_exist = 0;\r\n\r\n                // функционала добавления файла ajax нет\r\n                // const fileInputs = document.querySelectorAll(`.form-control_file_${form_id}`);\r\n                // if (fileInputs.length) {\r\n                //     const maxUploadSize = fileInputs[0].dataset.ufs;\r\n                //\r\n                //     Array.from(fileInputs[0].files).forEach((file) => {\r\n                //         if (file.size <= maxUploadSize) {\r\n                //             formData.append(\"files[]\", file);\r\n                //             file_exist = 1;\r\n                //         }\r\n                //     });\r\n                //\r\n                //     formData.append(\"dataForm\", form);\r\n                // }\r\n\r\n                // jquery\r\n                // if ($('.form-control_file' + form_id).length) {\r\n                //     const maxUploadSize = $('.form-control_file' + form_id).data('ufs');\r\n                //\r\n                //     $.each($('.form-control_file' + form_id)[0].files, function (i, file) {\r\n                //         if (file.size <= maxUploadSize) {\r\n                //             formData.append('files[]', file);\r\n                //             file_exist = 1;\r\n                //         }\r\n                //     });\r\n                //\r\n                //     formData.append('dataForm', $(\"#form_\" + form_id));\r\n                // }\r\n\r\n                fetch(`/form_fmc/api/add.php?ext_key=${extKey}`, {\r\n                    method: 'POST',\r\n                    cache: 'no-cache',\r\n                    body: JSON.stringify({\r\n                        send_ajax: 1,\r\n                        file_exist: file_exist,\r\n                        data: serializeArray,\r\n                    }),\r\n                    headers: {\r\n                        'Content-Type': 'application/json'\r\n                    }\r\n                })\r\n                    .then(response => response.text())\r\n                    .then(res => {\r\n                        /* Ecommerce - Покупка (для формы \"заказ в 1 клик\") */\r\n                        if (yam == 'ZAKAZ1CLICK') {\r\n                            window.dataLayer = window.dataLayer || [];\r\n\r\n                            let product_item = document.querySelector('.modal_order');\r\n                            const product_urlParams = new URLSearchParams(document.querySelector('.seo-btn-tovar-inner').dataset.src),\r\n                                product_id = product_urlParams.get('ext_var[tovarid]'),\r\n                                product_name = product_item.querySelector('.form__field_name div').textContent;\r\n                            let product_price;\r\n\r\n                            if(product_item.querySelector('.form__field_price .nowrap')){\r\n                                product_price = parseInt(product_item.querySelector('.form__field_price .nowrap').textContent.replace(/[^0-9]/gi, ''), 10);\r\n                            } else {\r\n                                product_price = 0;\r\n                            }\r\n\r\n                            dataLayer.push({\r\n                                \"ecommerce\": {\r\n                                    \"currencyCode\": \"RUB\",\r\n                                    \"purchase\": {\r\n                                        \"actionField\": {\r\n                                            \"id\": res\r\n                                        },\r\n                                        \"products\": [\r\n                                            {\r\n                                                \"id\": product_id,\r\n                                                \"name\": product_name,\r\n                                                \"price\": product_price,\r\n                                                //\"brand\": \"\",\r\n                                                //\"category\": \"\",\r\n                                                //\"variant\": \"\"\r\n                                                \"quantity\": 1\r\n                                            },\r\n                                        ]\r\n                                    }\r\n                                }\r\n                            });\r\n                        }\r\n                        /* /Ecommerce - Покупка (для формы \"заказ в 1 клик\") */\r\n\r\n                        if (res > 0) {\r\n                            clearFormData(formId);\r\n                            closeFormPopap(yam, text_send, formId, open_in_popap);\r\n\r\n                            // функционала добавления файла ajax нет\r\n                            // if (formData.get('files[]')) {\r\n                            //     fetch(`/form_fmc/api/add.php?id=${res}&ext_key=${form_id}`, {\r\n                            //         method: 'POST',\r\n                            //         body: formData,\r\n                            //     })\r\n                            //         .then(response => response.text())\r\n                            //         .then(data => {\r\n                            //             closeFormPopap(yam, text_send, form_id, open_in_popap);\r\n                            //         })\r\n                            //         .catch(error => console.error(error));\r\n                            //\r\n                            //     // jquery\r\n                            //     // $.ajax({\r\n                            //     //     url: \"/form_fmc/api/add.php?id=\" + res + \"&ext_key=\" + form_id,\r\n                            //     //     data: formData,\r\n                            //     //     cache: false,\r\n                            //     //     contentType: false,\r\n                            //     //     processData: false,\r\n                            //     //     type: 'POST',\r\n                            //     //     success: function (data) {\r\n                            //     //         closeFormPopap(yam, text_send, form_id, open_in_popap);\r\n                            //     //     }\r\n                            //     // });\r\n                            // } else {\r\n                            //     closeFormPopap(yam, text_send, form_id, open_in_popap);\r\n                            // }\r\n                        } else {\r\n                            hideLoader();\r\n                            if (res == 'long') {\r\n                                alert('Вы слишком быстро вводите данные формы! Сработала защита от спама. Попробуйте еще раз.');\r\n                                formButton.disabled = false;\r\n                                form.reset();\r\n                            } else if (res == 0) {\r\n                                alert('Сработала защита от взлома!');\r\n                                formButton.disabled = false;\r\n                                form.reset();\r\n                            }\r\n                        }\r\n                    })\r\n                    .catch(error => {\r\n                        console.error('Error:', error);\r\n                    });\r\n            }\r\n\r\n            if (type_send == \"reboot\") {\r\n                clearFormData(formId);\r\n                goYaM(yam);\r\n                // fancybox_success_message(text_send);\r\n                formSendRedirect();\r\n                setTimeout(function () {\r\n                    form.submit();\r\n                }, 1000);\r\n            }\r\n\r\n        }\r\n    });\r\n\r\n    if (form.querySelector(`.form_fmc_nf_time`).dataset.emb == \"1\") {\r\n        const time = Math.floor(Date.now() / 1000);\r\n        form.querySelector(`.form_fmc_nf_time`).value = time;\r\n    }\r\n\r\n    if (form.querySelector(`.form_fmc_page_from`).dataset.emb == \"1\") {\r\n        form.querySelector(`.form_fmc_page_from`).value = window.location.href;\r\n    }\r\n\r\n    // for Inputmask plugin\r\n    // $(\".mask_enter_exist\").each(function(){\r\n    //     var mmask = $(this).data('mask');\r\n    //     try {\r\n    //         Inputmask({\"mask\": mmask, \"positionCaretOnClick\": \"ignore\"}).mask($(this));\r\n    //     } catch (err) {\r\n    //         console.log(err);\r\n    //     }\r\n    // });\r\n\r\n    phoneInput('input[type=tel]');\r\n\r\n    // remove error-class on focus in form-controls\r\n    form.querySelectorAll(\".form-control, .checkbox__input, .radio__input\").forEach((formControl) => {\r\n        formControl.addEventListener(\"focus\", () => {\r\n            const formFieldError = formControl.closest('.form__field_error')\r\n            if(formFieldError){\r\n                formFieldError.classList.remove(\"form__field_error\");\r\n            }\r\n        });\r\n    });\r\n\r\n    // remove error-class on click in form-controls\r\n    form.querySelectorAll(\".form__field\").forEach((formField) => {\r\n        formField.addEventListener(\"click\", () => {\r\n            formField.classList.remove(\"form__field_error\");\r\n        });\r\n    });\r\n\r\n    // remove error-class on check form__field_personal\r\n    if(formFieldPersonal){\r\n        formFieldPersonalCheckbox.addEventListener(\"click\", () => {\r\n            if (formFieldPersonalCheckbox.checked) {\r\n                formFieldPersonal.classList.remove(\"form__field_error\");\r\n\r\n            }\r\n        });\r\n    }\r\n\r\n    // функционала добавления файла ajax нет (jquery)\r\n    // $(\"#id_form_add_file\" + form_id).change(function () {\r\n    //     const tt = $(this).data('tt');\r\n    //     const maxUploadSize = $(this).data('ufs');\r\n    //\r\n    //     if ($('.form-control_file' + form_id).length) {\r\n    //         showLoader();\r\n    //\r\n    //         let upload = true;\r\n    //         const formData = new FormData();\r\n    //\r\n    //         $.each($('.form-control_file' + form_id)[0].files, function (i, file) {\r\n    //             if (file.size <= maxUploadSize) {\r\n    //                 formData.append('files[]', file);\r\n    //             } else {\r\n    //                 upload = false;\r\n    //             }\r\n    //         });\r\n    //\r\n    //         if (upload) {\r\n    //             let ajax_file = \"\";\r\n    //             if (tt == \"file\") {\r\n    //                 ajax_file = \"file_validation\";\r\n    //             }\r\n    //             if (tt == \"fileimg\") {\r\n    //                 ajax_file = \"fileimg_validation\";\r\n    //             }\r\n    //\r\n    //             $.ajax({\r\n    //                 url: \"/form_fmc/api/\" + ajax_file + \".php\",\r\n    //                 data: formData,\r\n    //                 cache: false,\r\n    //                 contentType: false,\r\n    //                 processData: false,\r\n    //                 type: 'POST',\r\n    //                 success: function (data) {\r\n    //                     hideLoader();\r\n    //                     if (data == \"novalid\") {\r\n    //                         alert(\"Недопустимое расширение файла!\");\r\n    //                     }\r\n    //                 }\r\n    //             });\r\n    //         } else {\r\n    //             hideLoader();\r\n    //             alert(\"Превышен максимальный (5M) размер файла!\");\r\n    //         }\r\n    //     }\r\n    // });\r\n\r\n    setupFormHandlers(formId);\r\n    loadFormData(formId);\r\n}\r\n\r\nfunction closeFormPopap(yam, text_send, formId, open_in_popap) {\r\n    const form = document.forms[formId];\r\n\r\n    goYaM(yam);\r\n    // fancybox_success_message(text_send);\r\n    formSendRedirect();\r\n\r\n    form.querySelectorAll(\".form__field_error\").forEach(field => field.classList.remove(\"form__field_error\"));\r\n    form.reset();\r\n\r\n    setTimeout(function () {\r\n        Fancybox.close();\r\n        form.querySelector(`.form__button`).disabled = false;\r\n    }, 1000);\r\n}\r\n\r\nfunction goYaM(id) {\r\n    if (typeof (yaC) != \"undefined\" && id) {\r\n        ym(yaC, 'reachGoal', id);\r\n\r\n        // пользовательское событие GTM с id, который берется из названия цели яндекс метрики\r\n        if (typeof dataLayer !== 'undefined') {\r\n            dataLayer.push({'event': id});\r\n        }\r\n    }\r\n\r\n    // пользовательское событие GTM с id=formsend\r\n    if (typeof dataLayer !== 'undefined') {\r\n        dataLayer.push({'event': 'formsend'});\r\n    }\r\n}\r\n\r\nfunction isValidEmailAddress(emailAddress) {\r\n    const pattern = /^[\\S]+@[a-z0-9-]+\\.[a-z]{2,}$/i;\r\n    return pattern.test(emailAddress);\r\n}\r\n\r\nfunction isValidFio(fio){\r\n    const pattern = /^[a-zа-яё]+$/i; // только буквы\r\n    return pattern.test(fio);\r\n}\r\n\r\nfunction isValidTel(tel) {\r\n    const pattern = /^(\\+7|8)\\s\\(\\d{3}\\)\\s\\d{3}-\\d{2}-\\d{2}|\\+\\d+$/i; // тел вида +7 (___) ___-__-__ либо +***** (любое кол-во цифр начинающееся на плюс)\r\n    return pattern.test(tel);\r\n}\r\n\r\nfunction fancybox_success_message(text_send) {\r\n    hideLoader();\r\n\r\n    new Fancybox(\r\n        [{\r\n            src: '<div class=\"modal modal_success\">' +\r\n                '<div class=\"form__title\">Спасибо!</div>' +\r\n                '<div class=\"modal__text\">' + text_send + '</div>' +\r\n                '<button class=\"button form__button\" data-fancybox-close >Ok</button>' +\r\n                '</div>',\r\n            type: \"html\"\r\n        }],\r\n        {\r\n            autoFocus: false\r\n        }\r\n    );\r\n}\r\n\r\nfunction formSendRedirect(){\r\n    hideLoader();\r\n    window.location.href = window.location.origin + '/formSend/';\r\n}\r\n\r\n// Функция сохранения данных формы в localStorage\r\n// todo список чекбоксов и радио тоже сохранять\r\nfunction saveFormData(formName) {\r\n    const formData = {};\r\n    const form = document.forms[formName];\r\n\r\n    for (let i = 0; i < form.elements.length; i++) {\r\n        const element = form.elements[i];\r\n        if (element.name) {\r\n            if(element.type === 'checkbox' || element.type === 'radio'){\r\n                formData[element.name] = String(element.checked);\r\n            } else {\r\n                formData[element.name] = element.value;\r\n            }\r\n        }\r\n    }\r\n\r\n    localStorage.setItem(formName, JSON.stringify(formData));\r\n}\r\n\r\n// Функция очистки данных формы из localStorage\r\nfunction clearFormData(formName) {\r\n    localStorage.removeItem(formName);\r\n}\r\n\r\n// Функция подстановки данных из localStorage в форму\r\nfunction loadFormData(formName) {\r\n    const formData = JSON.parse(localStorage.getItem(formName));\r\n\r\n    if (formData) {\r\n        const form = document.forms[formName];\r\n\r\n        for (let i = 0; i < form.elements.length; i++) {\r\n            const element = form.elements[i];\r\n\r\n            if (element.name && formData[element.name]) {\r\n                if(element.type === 'checkbox' || element.type === 'radio'){\r\n                    element.checked = (formData[element.name] === 'true');\r\n                } else {\r\n                    element.value = formData[element.name];\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n// Функция, которая запускает функцию saveFormData при взаимодействии с элементами формы\r\nfunction setupFormHandlers(formName) {\r\n    const form = document.forms[formName];\r\n\r\n    for (let i = 0; i < form.elements.length; i++) {\r\n        const element = form.elements[i];\r\n        if ( (element.tagName === 'INPUT' && element.type !== 'checkbox' && element.type !== 'radio' && element.type !== 'hidden') || element.tagName === 'TEXTAREA') {\r\n            element.addEventListener('keyup', function() {\r\n                saveFormData(formName);\r\n            });\r\n        }\r\n\r\n        if (element.tagName === 'SELECT') {\r\n            element.addEventListener('change', function() {\r\n                saveFormData(formName);\r\n            });\r\n        }\r\n\r\n        if (element.type === 'checkbox' || element.type === 'radio') {\r\n            element.addEventListener('click', function() {\r\n                saveFormData(formName);\r\n            });\r\n        }\r\n    }\r\n}\r\n\r\nlet iclon = 1;\r\nfunction formFieldProductButton(fancybox, slide) {\r\n    document.querySelector('.form__field_product-button').addEventListener('click', (event) => {\r\n        event.preventDefault();\r\n\r\n        const formFieldProduct = document.querySelector('.form__field-wrapper_product');\r\n        const cloneFormFieldProduct = formFieldProduct.cloneNode(true);\r\n        cloneFormFieldProduct.querySelector('.form-control_select').setAttribute('id', '104_' + iclon);\r\n        cloneFormFieldProduct.querySelector('.form-control_select').setAttribute('name', 'field_104_' + iclon);\r\n        cloneFormFieldProduct.querySelector('.form__field_size input[type=text]').setAttribute('name', 'field_109_' + iclon);\r\n        cloneFormFieldProduct.querySelector('.form__field_size input[type=text]').setAttribute('id', '109_' + iclon);\r\n\r\n        const formFieldProductLast = document.querySelector('.form__field-wrapper_product:nth-last-child(2)');\r\n        formFieldProductLast.after(cloneFormFieldProduct);\r\n\r\n        iclon++;\r\n    });\r\n}"],"names":["initSubmitForm","formId","form","document","forms","extKey","dataset","formButton","querySelector","formFieldPersonal","let","formFieldPersonalCheckbox","time","addEventListener","e","preventDefault","not_empty_exist","not_valid_exist","valid_agree","checked","classList","add","querySelectorAll","forEach","field","value","closest","isValidFio","isValidEmailAddress","isValidTel","disabled","showLoader","text_send","data_text_send","type_send","yam","id_target_ym","open_in_popap","name","serializeArray","FormData","entries","push","fetch","method","cache","body","JSON","stringify","send_ajax","file_exist","data","headers","Content-Type","then","response","text","res","window","dataLayer","product_item","product_id","URLSearchParams","src","get","product_name","textContent","product_price","parseInt","replace","ecommerce","currencyCode","purchase","actionField","id","products","price","quantity","clearFormData","closeFormPopap","hideLoader","alert","reset","catch","error","console","goYaM","formSendRedirect","setTimeout","submit","emb","Math","floor","Date","now","location","href","phoneInput","formControl","formFieldError","remove","formField","setupFormHandlers","loadFormData","Fancybox","close","ym","yaC","event","emailAddress","test","fio","tel","fancybox_success_message","type","autoFocus","origin","saveFormData","formName","formData","i","elements","length","element","String","localStorage","setItem","removeItem","parse","getItem","tagName","bind","dragToClose","getComputedStyle","display","on","reveal","fancybox","slide","el","getAttribute","contentEl","contains","formFieldProductButton","err","log","iclon","cloneFormFieldProduct","cloneNode","setAttribute","after"],"mappings":"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"}